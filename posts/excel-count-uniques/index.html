<!DOCTYPE html>
<html lang="en"><meta charset="utf-8"><meta name="generator" content="Hugo 0.65.3" /><meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover">
<meta name="color-scheme" content="light dark">
<meta name="supported-color-schemes" content="light dark"><title>Excel 统计唯一值步骤分解&nbsp;&ndash;&nbsp;Keep Calm and Carry On Coding</title><link rel="stylesheet" href="/css/core.min.cf8ed48526ff196fc19fffd9d9778e0daaea7dbe4f20b4df97cdd483aa877f02522bd6ef294c8eae340a0e4446c33cc7.css" integrity="sha384-z47UhSb/GW/Bn//Z2XeODarqfb5PILTfl83Ug6qHfwJSK9bvKUyOrjQKDkRGwzzH"><body>
    <div class="base-body"><section id="header" class="site header">
    <div class="header wrap"><span class="header left-side"><a class="site home" href="/"><span class="site name">Keep Calm and Carry On Coding</span></a></span>
        <span class="header right-side"><div class="nav wrap"><nav class="nav"><a class="nav item" href="/categories/">Categories</a><a class="nav item" href="/tags/">Tags</a><a class="nav item" href="/about">About</a></nav></div></span></div></section><div id="content"><div class="article-container"><section class="article header">
    <h1 class="article title">Excel 统计唯一值步骤分解</h1><p class="article date">Wednesday, March 25, 2020</p></section><article class="article markdown-body"><h1 id="excel-统计唯一值的个数的方法以及解释">Excel 统计唯一值的个数的方法以及解释</h1>
<p>示例数据截图：</p>
<p><a target="_blank" rel="noopener noreferrer" 
  href="../images/countif-uniques.png"><img  src="../images/countif-uniques.png"
        alt="Sample"/></a></p>
<h3 id="一句话解释思路">一句话解释思路</h3>
<p>能实现的核心是：</p>
<ol>
<li>当 COUNTIF 的 criteria 参数不是传统的单个值，而是 range 本身的时候，i.e. countif(C6:C40,C6:C40) ，函数会将其理解为对 range 的每一个 value 代入 criteria 参数并求值，这个 (range,range) 的写法相当于:</li>
</ol>
<blockquote>
<p>countif(range, c6)</p>
<p>countif(range, c7)</p>
<p>countif(range, c8)</p>
<p>&hellip;</p>
</blockquote>
<ol>
<li>正如上图所示，此时 countif 列会显示每一个 value 的条件和，<strong>包括那些重复的 value，此时每一个重复值的条件和都会大于1，且等于重复次数</strong>，即此时数据陈列满足: 有 n 个 $\frac{1}{n}$</li>
<li>接下来就简单了，$\sum_ \ \frac{1}{n}$即可（必等于1），从而求出唯一值的个数。</li>
<li>btw, countif(range,range) 实际上是返回一个二维数组（array）。</li>
</ol>
<h3 id="使用函数">使用函数</h3>
<ul>
<li>countif</li>
<li>sum</li>
</ul>
<h3 id="完整函数表达">完整函数表达</h3>
<pre><code class="language-vba" data-lang="vba">=sum(1/(countif(range,range)))
</code></pre></article><section class="article labels"><a class="category" href=/categories/statistic/>Statistic</a><a class="tag" href=/tags/excel/>Excel</a></section><section class="article license">MIT License</section></div><section class="article navigation"><p><a class="link" href="/posts/reading-list/"><span class="li">&rarr;</span>Reading list on Matplotlib</a></p></section></div><section id="footer" class="footer"><div class="footer-wrap">
    <p class="copyright">MIT License</p>
    <p class="powerby"><span>Powered by </span><a href="https://gohugo.io" 
        target="_blank">Hugo</a><span> and the </span><a href="https://themes.gohugo.io/hugo-notepadium/" 
        target="_blank">Notepadium</a></p>
</div></section><script defer type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-AMS-MML_HTMLorMML" integrity="sha384-e/4/LvThKH1gwzXhdbY2AsjR3rm7LHWyhIG5C0jiRfn8AN2eTN5ILeztWw0H9jmN" crossorigin="anonymous"></script>
        <script
            type="text/x-mathjax-config">MathJax.Hub.Config({ tex2jax: { inlineMath: [['$','$'], ['\\(','\\)']] } });</script></div>
</body>

</html>